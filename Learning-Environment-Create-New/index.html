
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Unity Machine Learning Agents Toolkit (ML-Agents) is an open-source project that enables games and simulations to serve as environments for training intelligent agents.">
      
      
        <meta name="author" content="Unity Technologies">
      
      
        <link rel="canonical" href="https://unity-technologies.github.io/ml-agents/Learning-Environment-Create-New/">
      
      
      
      
      <link rel="icon" href="../images/unity-logo-black.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>Making a New Learning Environment - Unity ML-Agents Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#making-a-new-learning-environment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Unity ML-Agents Toolkit" class="md-header__button md-logo" aria-label="Unity ML-Agents Toolkit" data-md-component="logo">
      
  <img src="../images/unity-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Unity ML-Agents Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Making a New Learning Environment
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Unity-Technologies/ml-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Unity ML-Agents Toolkit" class="md-nav__button md-logo" aria-label="Unity ML-Agents Toolkit" data-md-component="logo">
      
  <img src="../images/unity-logo.png" alt="logo">

    </a>
    Unity ML-Agents Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Unity-Technologies/ml-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../ML-Agents-Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ML-Agents Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../ML-Agents-Toolkit-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toolkit Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Background
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Background
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Background-Machine-Learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Background-PyTorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Background-Unity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ELO-Rating-System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ELO
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interfacing with Unity Builds
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Interfacing with Unity Builds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Gym-API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with the Gym API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-PettingZoo-API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with the PettingZoo API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-LLAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with the LLAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python API Docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Python API Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Gym-API-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gym API Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-PettingZoo-API-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Petting Zoo Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-LLAPI-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLAPI Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-On-Off-Policy-Trainer-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    On/Off Policy Trainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Training-Plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customizing Training via Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Tutorial-Custom-Trainer-Plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Trainer Plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Hugging-Face-Integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HuggingFace
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Limitations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Limitations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Migrating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrating
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-the-unity-project" class="md-nav__link">
    Set Up the Unity Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-environment" class="md-nav__link">
    Create the Environment
  </a>
  
    <nav class="md-nav" aria-label="Create the Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-floor-plane" class="md-nav__link">
    Create the Floor Plane
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-the-target-cube" class="md-nav__link">
    Add the Target Cube
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-the-agent-sphere" class="md-nav__link">
    Add the Agent Sphere
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-into-training-area" class="md-nav__link">
    Group into Training Area
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-an-agent" class="md-nav__link">
    Implement an Agent
  </a>
  
    <nav class="md-nav" aria-label="Implement an Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-and-resetting-the-agent" class="md-nav__link">
    Initialization and Resetting the Agent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observing-the-environment" class="md-nav__link">
    Observing the Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taking-actions-and-assigning-rewards" class="md-nav__link">
    Taking Actions and Assigning Rewards
  </a>
  
    <nav class="md-nav" aria-label="Taking Actions and Assigning Rewards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    Actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rewards" class="md-nav__link">
    Rewards
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onactionreceived" class="md-nav__link">
    OnActionReceived()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-agent-setup-in-editor" class="md-nav__link">
    Final Agent Setup in Editor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-environment" class="md-nav__link">
    Testing the Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-the-environment" class="md-nav__link">
    Training the Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-multiple-training-areas-within-the-same-scene" class="md-nav__link">
    Optional: Multiple Training Areas within the Same Scene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-training-using-concurrent-unity-instances" class="md-nav__link">
    Optional: Training Using Concurrent Unity Instances
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="making-a-new-learning-environment">Making a New Learning Environment</h1>
<p>This tutorial walks through the process of creating a Unity Environment from
scratch. We recommend first reading the <a href="../Getting-Started/">Getting Started</a>
guide to understand the concepts presented here first in an already-built
environment.</p>
<p><img alt="A simple ML-Agents environment" src="../images/mlagents-NewTutSplash.png" /></p>
<p>In this example, we will create an agent capable of controlling a ball on a
platform. We will then train the agent to roll the ball toward the cube while
avoiding falling off the platform.</p>
<h2 id="overview">Overview</h2>
<p>Using the ML-Agents Toolkit in a Unity project involves the following basic
steps:</p>
<ol>
<li>Create an environment for your agents to live in. An environment can range
   from a simple physical simulation containing a few objects to an entire game
   or ecosystem.</li>
<li>Implement your Agent subclasses. An Agent subclass defines the code an Agent
   uses to observe its environment, to carry out assigned actions, and to
   calculate the rewards used for reinforcement training. You can also implement
   optional methods to reset the Agent when it has finished or failed its task.</li>
<li>Add your Agent subclasses to appropriate GameObjects, typically, the object
   in the scene that represents the Agent in the simulation.</li>
</ol>
<p><strong>Note:</strong> If you are unfamiliar with Unity, refer to the
<a href="https://docs.unity3d.com/Manual/index.html">Unity manual</a>
if an Editor task isn't explained sufficiently in this tutorial.</p>
<p>If you haven't already, follow the <a href="../Installation/">installation instructions</a>.</p>
<h2 id="set-up-the-unity-project">Set Up the Unity Project</h2>
<p>The first task to accomplish is simply creating a new Unity project and
importing the ML-Agents assets into it:</p>
<ol>
<li>Launch Unity Hub and create a new 3D project named "RollerBall".</li>
<li><a href="../Installation/#install-the-comunityml-agents-unity-package">Add the ML-Agents Unity package</a>
   to your project.</li>
</ol>
<p>Your Unity <strong>Project</strong> window should contain the following assets:</p>
<p align="left">
  <img src="images/roller-ball-projects.png"
       alt="Project window"
       width="250" border="10" />
</p>

<h2 id="create-the-environment">Create the Environment</h2>
<p>Next, we will create a very simple scene to act as our learning environment. The
"physical" components of the environment include a Plane to act as the floor for
the Agent to move around on, a Cube to act as the goal or target for the agent
to seek, and a Sphere to represent the Agent itself.</p>
<h3 id="create-the-floor-plane">Create the Floor Plane</h3>
<ol>
<li>Right click in Hierarchy window, select 3D Object &gt; Plane.</li>
<li>Name the GameObject "Floor".</li>
<li>Select the Floor Plane to view its properties in the Inspector window.</li>
<li>Set Transform to Position = <code>(0, 0, 0)</code>, Rotation = <code>(0, 0, 0)</code>, Scale =
   <code>(1, 1, 1)</code>.</li>
</ol>
<p align="left">
  <img src="images/roller-ball-floor.png"
       alt="The Floor in the Inspector window"
       width="400" border="10" />
</p>

<h3 id="add-the-target-cube">Add the Target Cube</h3>
<ol>
<li>Right click in Hierarchy window, select 3D Object &gt; Cube.</li>
<li>Name the GameObject "Target".</li>
<li>Select the Target Cube to view its properties in the Inspector window.</li>
<li>Set Transform to Position = <code>(3, 0.5, 3)</code>, Rotation = <code>(0, 0, 0)</code>, Scale =
   <code>(1, 1, 1)</code>.</li>
</ol>
<p align="left">
  <img src="images/roller-ball-target.png"
       alt="The Target Cube in the Inspector window"
       width="400" border="10" />
</p>

<h3 id="add-the-agent-sphere">Add the Agent Sphere</h3>
<ol>
<li>Right click in Hierarchy window, select 3D Object &gt; Sphere.</li>
<li>Name the GameObject "RollerAgent".</li>
<li>Select the RollerAgent Sphere to view its properties in the Inspector window.</li>
<li>Set Transform to Position = <code>(0, 0.5, 0)</code>, Rotation = <code>(0, 0, 0)</code>, Scale =
   <code>(1, 1, 1)</code>.</li>
<li>Click <strong>Add Component</strong>.</li>
<li>Add the <code>Rigidbody</code> component to the Sphere.</li>
</ol>
<h3 id="group-into-training-area">Group into Training Area</h3>
<p>Group the floor, target and agent under a single, empty, GameObject. This will simplify
some of our subsequent steps.</p>
<p>To do so:</p>
<ol>
<li>Right-click on your Project Hierarchy and create a new empty GameObject. Name
   it TrainingArea.</li>
<li>Reset the TrainingArea’s Transform so that it is at <code>(0,0,0)</code> with Rotation
   <code>(0,0,0)</code> and Scale <code>(1,1,1)</code>.</li>
<li>Drag the Floor, Target, and RollerAgent GameObjects in the Hierarchy into the
   TrainingArea GameObject.</li>
</ol>
<p align="left">
  <img src="images/roller-ball-hierarchy.png"
       alt="The Hierarchy window"
       width="250" border="10" />
</p>

<h2 id="implement-an-agent">Implement an Agent</h2>
<p>To create the Agent Script:</p>
<ol>
<li>Select the RollerAgent GameObject to view it in the Inspector window.</li>
<li>Click <strong>Add Component</strong>.</li>
<li>Click <strong>New Script</strong> in the list of components (at the bottom).</li>
<li>Name the script "RollerAgent".</li>
<li>Click <strong>Create and Add</strong>.</li>
</ol>
<p>Then, edit the new <code>RollerAgent</code> script:</p>
<ol>
<li>In the Unity Project window, double-click the <code>RollerAgent</code> script to open it
   in your code editor.</li>
<li>Import ML-Agent package by adding</li>
</ol>
<p><code>csharp
   using Unity.MLAgents;
   using Unity.MLAgents.Sensors;
   using Unity.MLAgents.Actuators;</code>
   then change the base class from <code>MonoBehaviour</code> to <code>Agent</code>.
1. Delete <code>Update()</code> since we are not using it, but keep <code>Start()</code>.</p>
<p>So far, these are the basic steps that you would use to add ML-Agents to any
Unity project. Next, we will add the logic that will let our Agent learn to roll
to the cube using reinforcement learning. More specifically, we will need to
extend three methods from the <code>Agent</code> base class:</p>
<ul>
<li><code>OnEpisodeBegin()</code></li>
<li><code>CollectObservations(VectorSensor sensor)</code></li>
<li><code>OnActionReceived(ActionBuffers actionBuffers)</code></li>
</ul>
<p>We overview each of these in more detail in the dedicated subsections below.</p>
<h3 id="initialization-and-resetting-the-agent">Initialization and Resetting the Agent</h3>
<p>The process of training in the ML-Agents Toolkit involves running episodes where
the Agent (Sphere) attempts to solve the task. Each episode lasts until the
Agents solves the task (i.e. reaches the cube), fails (rolls off the platform)
or times out (takes too long to solve or fail at the task). At the start of each
episode, <code>OnEpisodeBegin()</code> is called to set-up the environment for a
new episode. Typically the scene is initialized in a random manner to enable the
agent to learn to solve the task under a variety of conditions.</p>
<p>In this example, each time the Agent (Sphere) reaches its target (Cube), the
episode ends and the target (Cube) is moved to a new random location; and if
the Agent rolls off the platform, it will be put back onto the floor.
These are all handled in <code>OnEpisodeBegin()</code>.</p>
<p>To move the target (Cube), we need a reference to its Transform (which stores a
GameObject's position, orientation and scale in the 3D world). To get this
reference, add a public field of type <code>Transform</code> to the RollerAgent class.
Public fields of a component in Unity get displayed in the Inspector window,
allowing you to choose which GameObject to use as the target in the Unity
Editor.</p>
<p>To reset the Agent's velocity (and later to apply force to move the agent) we
need a reference to the Rigidbody component. A
<a href="https://docs.unity3d.com/ScriptReference/Rigidbody.html">Rigidbody</a> is Unity's
primary element for physics simulation. (See
<a href="https://docs.unity3d.com/Manual/PhysicsSection.html">Physics</a> for full
documentation of Unity physics.) Since the Rigidbody component is on the same
GameObject as our Agent script, the best way to get this reference is using
<code>GameObject.GetComponent&lt;T&gt;()</code>, which we can call in our script's <code>Start()</code>
method.</p>
<p>So far, our RollerAgent script looks like:</p>
<pre><code class="language-csharp">using System.Collections.Generic;
using UnityEngine;
using Unity.MLAgents;
using Unity.MLAgents.Sensors;

public class RollerAgent : Agent
{
    Rigidbody rBody;
    void Start () {
        rBody = GetComponent&lt;Rigidbody&gt;();
    }

    public Transform Target;
    public override void OnEpisodeBegin()
    {
       // If the Agent fell, zero its momentum
        if (this.transform.localPosition.y &lt; 0)
        {
            this.rBody.angularVelocity = Vector3.zero;
            this.rBody.velocity = Vector3.zero;
            this.transform.localPosition = new Vector3( 0, 0.5f, 0);
        }

        // Move the target to a new spot
        Target.localPosition = new Vector3(Random.value * 8 - 4,
                                           0.5f,
                                           Random.value * 8 - 4);
    }
}
</code></pre>
<p>Next, let's implement the <code>Agent.CollectObservations(VectorSensor sensor)</code>
method.</p>
<h3 id="observing-the-environment">Observing the Environment</h3>
<p>The Agent sends the information we collect to the Brain, which uses it to make a
decision. When you train the Agent (or use a trained model), the data is fed
into a neural network as a feature vector. For an Agent to successfully learn a
task, we need to provide the correct information. A good rule of thumb for
deciding what information to collect is to consider what you would need to
calculate an analytical solution to the problem.</p>
<p>In our case, the information our Agent collects includes the position of the
target, the position of the agent itself, and the velocity of the agent. This
helps the Agent learn to control its speed so it doesn't overshoot the target
and roll off the platform. In total, the agent observation contains 8 values as
implemented below:</p>
<pre><code class="language-csharp">public override void CollectObservations(VectorSensor sensor)
{
    // Target and Agent positions
    sensor.AddObservation(Target.localPosition);
    sensor.AddObservation(this.transform.localPosition);

    // Agent velocity
    sensor.AddObservation(rBody.velocity.x);
    sensor.AddObservation(rBody.velocity.z);
}
</code></pre>
<h3 id="taking-actions-and-assigning-rewards">Taking Actions and Assigning Rewards</h3>
<p>The final part of the Agent code is the <code>Agent.OnActionReceived()</code> method, which
receives actions and assigns the reward.</p>
<h4 id="actions">Actions</h4>
<p>To solve the task of moving towards the target, the Agent (Sphere) needs to be
able to move in the <code>x</code> and <code>z</code> directions. As such, the agent needs 2 actions:
the first determines the force applied along the x-axis; and the
second determines the force applied along the z-axis. (If we allowed the Agent
to move in three dimensions, then we would need a third action.)</p>
<p>The RollerAgent applies the values from the <code>action[]</code> array to its Rigidbody
component <code>rBody</code>, using <code>Rigidbody.AddForce()</code>:</p>
<pre><code class="language-csharp">Vector3 controlSignal = Vector3.zero;
controlSignal.x = action[0];
controlSignal.z = action[1];
rBody.AddForce(controlSignal * forceMultiplier);
</code></pre>
<h4 id="rewards">Rewards</h4>
<p>Reinforcement learning requires rewards to signal which decisions are good and
which are bad. The learning algorithm uses the rewards to determine whether it
is giving the Agent the optimal actions. You want to reward an Agent for
completing the assigned task. In this case, the Agent is given a reward of 1.0
for reaching the Target cube.</p>
<p>Rewards are assigned in <code>OnActionReceived()</code>. The RollerAgent
calculates the distance to detect when it reaches the target.
When it does, the code calls <code>Agent.SetReward()</code> to assign a reward
of 1.0 and marks the agent as finished by calling <code>EndEpisode()</code> on
the Agent.</p>
<pre><code class="language-csharp">float distanceToTarget = Vector3.Distance(this.transform.localPosition, Target.localPosition);
// Reached target
if (distanceToTarget &lt; 1.42f)
{
    SetReward(1.0f);
    EndEpisode();
}
</code></pre>
<p>Finally, if the Agent falls off the platform, end the episode so that it can
reset itself:</p>
<pre><code class="language-csharp">// Fell off platform
if (this.transform.localPosition.y &lt; 0)
{
    EndEpisode();
}
</code></pre>
<h4 id="onactionreceived">OnActionReceived()</h4>
<p>With the action and reward logic outlined above, the final version of
<code>OnActionReceived()</code> looks like:</p>
<pre><code class="language-csharp">public float forceMultiplier = 10;
public override void OnActionReceived(ActionBuffers actionBuffers)
{
    // Actions, size = 2
    Vector3 controlSignal = Vector3.zero;
    controlSignal.x = actionBuffers.ContinuousActions[0];
    controlSignal.z = actionBuffers.ContinuousActions[1];
    rBody.AddForce(controlSignal * forceMultiplier);

    // Rewards
    float distanceToTarget = Vector3.Distance(this.transform.localPosition, Target.localPosition);

    // Reached target
    if (distanceToTarget &lt; 1.42f)
    {
        SetReward(1.0f);
        EndEpisode();
    }

    // Fell off platform
    else if (this.transform.localPosition.y &lt; 0)
    {
        EndEpisode();
    }
}
</code></pre>
<p>Note the <code>forceMultiplier</code> class variable is defined before the method definition.
Since <code>forceMultiplier</code> is public, you can set the value from the Inspector window.</p>
<h2 id="final-agent-setup-in-editor">Final Agent Setup in Editor</h2>
<p>Now that all the GameObjects and ML-Agent components are in place, it is time
to connect everything together in the Unity Editor. This involves adding and
setting some of the Agent Component's properties so that they are compatible
with our Agent script.</p>
<ol>
<li>Select the <strong>RollerAgent</strong> GameObject to show its properties in the Inspector
   window.</li>
<li>Drag the Target GameObject in the Hierarchy into the <code>Target</code> field in RollerAgent Script.</li>
<li>Add a <code>Decision Requester</code> script with the <strong>Add Component</strong> button.
   Set the <strong>Decision Period</strong> to <code>10</code>. For more information on decisions,
   see <a href="../Learning-Environment-Design-Agents/#decisions">the Agent documentation</a></li>
<li>Add a <code>Behavior Parameters</code> script with the <strong>Add Component</strong> button.
   Set the Behavior Parameters of the Agent to the following:</li>
<li><code>Behavior Name</code>: <em>RollerBall</em></li>
<li><code>Vector Observation</code> &gt; <code>Space Size</code> = 8</li>
<li><code>Actions</code> &gt; <code>Continuous Actions</code> = 2</li>
</ol>
<p>In the inspector, the <code>RollerAgent</code> should look like this now:</p>
<p align="left">
  <img src="images/roller-ball-agent.png"
       alt="The Agent GameObject in the Inspector window"
       width="400" border="5" />
</p>

<p>Now you are ready to test the environment before training.</p>
<h2 id="testing-the-environment">Testing the Environment</h2>
<p>It is always a good idea to first test your environment by controlling the Agent
using the keyboard. To do so, you will need to extend the <code>Heuristic()</code> method
in the <code>RollerAgent</code> class. For our example, the heuristic will generate an
action corresponding to the values of the "Horizontal" and "Vertical" input axis
(which correspond to the keyboard arrow keys):</p>
<pre><code class="language-csharp">public override void Heuristic(in ActionBuffers actionsOut)
{
    var continuousActionsOut = actionsOut.ContinuousActions;
    continuousActionsOut[0] = Input.GetAxis(&quot;Horizontal&quot;);
    continuousActionsOut[1] = Input.GetAxis(&quot;Vertical&quot;);
}
</code></pre>
<p>In order for the Agent to use the Heuristic, You will need to set the
<code>Behavior Type</code> to <code>Heuristic Only</code> in the <code>Behavior Parameters</code> of the
RollerAgent.</p>
<p>Press <strong>Play</strong> to run the scene and use the arrows keys to move the Agent around
the platform. Make sure that there are no errors displayed in the Unity Editor
Console window and that the Agent resets when it reaches its target or falls
from the platform.</p>
<h2 id="training-the-environment">Training the Environment</h2>
<p>The process is the same as described in the
<a href="../Getting-Started/">Getting Started Guide</a>.</p>
<p>The hyperparameters for training are specified in a configuration file that you
pass to the <code>mlagents-learn</code> program. Create a new <code>rollerball_config.yaml</code> file
under <code>config/</code> and include the following hyperparameter values:</p>
<pre><code class="language-yml">behaviors:
  RollerBall:
    trainer_type: ppo
    hyperparameters:
      batch_size: 10
      buffer_size: 100
      learning_rate: 3.0e-4
      beta: 5.0e-4
      epsilon: 0.2
      lambd: 0.99
      num_epoch: 3
      learning_rate_schedule: linear
      beta_schedule: constant
      epsilon_schedule: linear
    network_settings:
      normalize: false
      hidden_units: 128
      num_layers: 2
    reward_signals:
      extrinsic:
        gamma: 0.99
        strength: 1.0
    max_steps: 500000
    time_horizon: 64
    summary_freq: 10000
</code></pre>
<p>Hyperparameters are explained in <a href="../Training-Configuration-File/">the training configuration file documentation</a></p>
<p>Since this example creates a very simple training environment with only a few
inputs and outputs, using small batch and buffer sizes speeds up the training
considerably. However, if you add more complexity to the environment or change
the reward or observation functions, you might also find that training performs
better with different hyperparameter values. In addition to setting these
hyperparameter values, the Agent <strong>DecisionFrequency</strong> parameter has a large
effect on training time and success. A larger value reduces the number of
decisions the training algorithm has to consider and, in this simple
environment, speeds up training.</p>
<p>To train your agent, run the following command before pressing <strong>Play</strong> in the
Editor:</p>
<pre><code>mlagents-learn config/rollerball_config.yaml --run-id=RollerBall
</code></pre>
<p>To monitor the statistics of Agent performance during training, use
<a href="../Using-Tensorboard/">TensorBoard</a>.</p>
<p><img alt="TensorBoard statistics display" src="../images/mlagents-RollerAgentStats.png" /></p>
<p>In particular, the <em>cumulative_reward</em> and <em>value_estimate</em> statistics show how
well the Agent is achieving the task. In this example, the maximum reward an
Agent can earn is 1.0, so these statistics approach that value when the Agent
has successfully <em>solved</em> the problem.</p>
<h2 id="optional-multiple-training-areas-within-the-same-scene">Optional: Multiple Training Areas within the Same Scene</h2>
<p>In many of the <a href="../Learning-Environment-Examples/">example environments</a>, many
copies of the training area are instantiated in the scene. This generally speeds
up training, allowing the environment to gather many experiences in parallel.
This can be achieved simply by instantiating many Agents with the same
<code>Behavior Name</code>. Note that we've already simplified our transition to using
multiple areas by creating the <code>TrainingArea</code> GameObject and relying on local
positions in <code>RollerAgent.cs</code>. Use the following steps to parallelize your
RollerBall environment:</p>
<ol>
<li>Drag the TrainingArea GameObject, along with its attached GameObjects, into
   your Assets browser, turning it into a prefab.</li>
<li>You can now instantiate copies of the TrainingArea prefab. Drag them into
   your scene, positioning them so that they do not overlap.</li>
</ol>
<p>Alternatively, you can use the <code>TrainingAreaReplicator</code> to replicate training areas. Use the following steps:</p>
<ol>
<li>Create a new empty Game Object in the scene.</li>
<li>Click on the new object and add a TrainingAreaReplicator component to the empty Game Object through the inspector.</li>
<li>Drag the training area to <code>Base Area</code> in the Training Area Replicator.</li>
<li>Specify the number of areas to replicate and the separation between areas.</li>
<li>Hit play and the areas will be replicated automatically!</li>
</ol>
<h2 id="optional-training-using-concurrent-unity-instances">Optional: Training Using Concurrent Unity Instances</h2>
<p>Another level of parallelization comes by training using
<a href="../ML-Agents-Overview/#additional-features">concurrent Unity instances</a>.
For example,</p>
<pre><code>mlagents-learn config/rollerball_config.yaml --run-id=RollerBall --num-envs=2
</code></pre>
<p>will start ML Agents training with two environment instances. Combining multiple
training areas within the same scene, with concurrent Unity instances, effectively
gives you two levels of parallelism to speed up training. The command line option
<code>--num-envs=&lt;n&gt;</code> controls the number of concurrent Unity instances that are
executed in parallel during training.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      com.unity.ml-agents copyright © 2017 - 2022 Unity Technologies
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.94c44541.min.js"></script>
      
    
  </body>
</html>