
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Unity Machine Learning Agents Toolkit (ML-Agents) is an open-source project that enables games and simulations to serve as environments for training intelligent agents.">
      
      
        <meta name="author" content="Unity Technologies">
      
      
        <link rel="canonical" href="https://unity-technologies.github.io/ml-agents/Getting-Started/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Getting Started Guide - Unity ML-Agents Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Unity ML-Agents Toolkit" class="md-header__button md-logo" aria-label="Unity ML-Agents Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Unity ML-Agents Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Unity-Technologies/ml-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Unity ML-Agents Toolkit" class="md-nav__button md-logo" aria-label="Unity ML-Agents Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Unity ML-Agents Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Unity-Technologies/ml-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ML-Agents-Overview/" class="md-nav__link">
        ML-Agents Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ML-Agents-Toolkit-Documentation/" class="md-nav__link">
        Toolkit Documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Background
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Background" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Background
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Background-Machine-Learning/" class="md-nav__link">
        Machine Learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Background-PyTorch/" class="md-nav__link">
        PyTorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Background-Unity/" class="md-nav__link">
        Unity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Interfacing with Unity Builds
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Interfacing with Unity Builds" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Interfacing with Unity Builds
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Gym-API/" class="md-nav__link">
        Getting started with the Gym API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-PettingZoo-API/" class="md-nav__link">
        Getting started with the PettingZoo API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-LLAPI/" class="md-nav__link">
        Getting started with the LLAPI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Python API Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python API Docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Python API Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Gym-API-Documentation/" class="md-nav__link">
        Gym API Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-PettingZoo-API-Documentation/" class="md-nav__link">
        Petting Zoo Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-LLAPI-Documentation/" class="md-nav__link">
        LLAPI Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-On-Off-Policy-Trainer-Documentation/" class="md-nav__link">
        On/Off Policy Trainer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        FAQs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Limitations/" class="md-nav__link">
        Limitations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Migrating/" class="md-nav__link">
        Migrating
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-a-unity-environment" class="md-nav__link">
    Understanding a Unity Environment
  </a>
  
    <nav class="md-nav" aria-label="Understanding a Unity Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agent" class="md-nav__link">
    Agent
  </a>
  
    <nav class="md-nav" aria-label="Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavior-parameters-vector-observation-space" class="md-nav__link">
    Behavior Parameters : Vector Observation Space
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavior-parameters-actions" class="md-nav__link">
    Behavior Parameters : Actions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-a-pre-trained-model" class="md-nav__link">
    Running a pre-trained model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-a-new-model-with-reinforcement-learning" class="md-nav__link">
    Training a new model with Reinforcement Learning
  </a>
  
    <nav class="md-nav" aria-label="Training a new model with Reinforcement Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training-the-environment" class="md-nav__link">
    Training the environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observing-training-progress" class="md-nav__link">
    Observing Training Progress
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-the-model-into-the-unity-environment" class="md-nav__link">
    Embedding the model into the Unity Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/Unity-Technologies/ml-agents/edit/main/docs/Getting-Started.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="getting-started-guide">Getting Started Guide</h1>
<p>This guide walks through the end-to-end process of opening one of our
<a href="../Learning-Environment-Examples/">example environments</a> in Unity, training an
Agent in it, and embedding the trained model into the Unity environment. After
reading this tutorial, you should be able to train any of the example
environments. If you are not familiar with the
<a href="https://unity3d.com/unity">Unity Engine</a>, view our
<a href="../Background-Unity/">Background: Unity</a> page for helpful pointers.
Additionally, if you're not familiar with machine learning, view our
<a href="../Background-Machine-Learning/">Background: Machine Learning</a> page for a brief
overview and helpful pointers.</p>
<p><img alt="3D Balance Ball" src="../images/balance.png" /></p>
<p>For this guide, we'll use the <strong>3D Balance Ball</strong> environment which contains a
number of agent cubes and balls (which are all copies of each other). Each agent
cube tries to keep its ball from falling by rotating either horizontally or
vertically. In this environment, an agent cube is an <strong>Agent</strong> that receives a
reward for every step that it balances the ball. An agent is also penalized with
a negative reward for dropping the ball. The goal of the training process is to
have the agents learn to balance the ball on their head.</p>
<p>Let's get started!</p>
<h2 id="installation">Installation</h2>
<p>If you haven't already, follow the <a href="../Installation/">installation instructions</a>.
Afterwards, open the Unity Project that contains all the example environments:</p>
<ol>
<li>Open the Package Manager Window by navigating to <code>Window -&gt; Package Manager</code>
   in the menu.</li>
<li>Navigate to the ML-Agents Package and click on it.</li>
<li>Find the <code>3D Ball</code> sample and click <code>Import</code>.</li>
<li>In the <strong>Project</strong> window, go to the
   <code>Assets/ML-Agents/Examples/3DBall/Scenes</code> folder and open the <code>3DBall</code> scene
   file.</li>
</ol>
<h2 id="understanding-a-unity-environment">Understanding a Unity Environment</h2>
<p>An agent is an autonomous actor that observes and interacts with an
<em>environment</em>. In the context of Unity, an environment is a scene containing one
or more Agent objects, and, of course, the other entities that an agent
interacts with.</p>
<p><img alt="Unity Editor" src="../images/mlagents-3DBallHierarchy.png" /></p>
<p><strong>Note:</strong> In Unity, the base object of everything in a scene is the
<em>GameObject</em>. The GameObject is essentially a container for everything else,
including behaviors, graphics, physics, etc. To see the components that make up
a GameObject, select the GameObject in the Scene window, and open the Inspector
window. The Inspector shows every component on a GameObject.</p>
<p>The first thing you may notice after opening the 3D Balance Ball scene is that
it contains not one, but several agent cubes. Each agent cube in the scene is an
independent agent, but they all share the same Behavior. 3D Balance Ball does
this to speed up training since all twelve agents contribute to training in
parallel.</p>
<h3 id="agent">Agent</h3>
<p>The Agent is the actor that observes and takes actions in the environment. In
the 3D Balance Ball environment, the Agent components are placed on the twelve
"Agent" GameObjects. The base Agent object has a few properties that affect its
behavior:</p>
<ul>
<li><strong>Behavior Parameters</strong> — Every Agent must have a Behavior. The Behavior
  determines how an Agent makes decisions.</li>
<li><strong>Max Step</strong> — Defines how many simulation steps can occur before the Agent's
  episode ends. In 3D Balance Ball, an Agent restarts after 5000 steps.</li>
</ul>
<h4 id="behavior-parameters-vector-observation-space">Behavior Parameters : Vector Observation Space</h4>
<p>Before making a decision, an agent collects its observation about its state in
the world. The vector observation is a vector of floating point numbers which
contain relevant information for the agent to make decisions.</p>
<p>The Behavior Parameters of the 3D Balance Ball example uses a <code>Space Size</code> of 8.
This means that the feature vector containing the Agent's observations contains
eight elements: the <code>x</code> and <code>z</code> components of the agent cube's rotation and the
<code>x</code>, <code>y</code>, and <code>z</code> components of the ball's relative position and velocity.</p>
<h4 id="behavior-parameters-actions">Behavior Parameters : Actions</h4>
<p>An Agent is given instructions in the form of actions.
ML-Agents Toolkit classifies actions into two types: continuous and discrete.
The 3D Balance Ball example is programmed to use continuous actions, which
are a vector of floating-point numbers that can vary continuously. More specifically,
it uses a <code>Space Size</code> of 2 to control the amount of <code>x</code> and <code>z</code> rotations to apply to
itself to keep the ball balanced on its head.</p>
<h2 id="running-a-pre-trained-model">Running a pre-trained model</h2>
<p>We include pre-trained models for our agents (<code>.onnx</code> files) and we use the
<a href="../Unity-Inference-Engine/">Unity Inference Engine</a> to run these models inside
Unity. In this section, we will use the pre-trained model for the 3D Ball
example.</p>
<ol>
<li>In the <strong>Project</strong> window, go to the
   <code>Assets/ML-Agents/Examples/3DBall/Prefabs</code> folder. Expand <code>3DBall</code> and click
   on the <code>Agent</code> prefab. You should see the <code>Agent</code> prefab in the <strong>Inspector</strong>
   window.</li>
</ol>
<p><strong>Note</strong>: The platforms in the <code>3DBall</code> scene were created using the <code>3DBall</code>
   prefab. Instead of updating all 12 platforms individually, you can update the
   <code>3DBall</code> prefab instead.</p>
<p><img alt="Platform Prefab" src="../images/platform_prefab.png" /></p>
<ol>
<li>In the <strong>Project</strong> window, drag the <strong>3DBall</strong> Model located in
   <code>Assets/ML-Agents/Examples/3DBall/TFModels</code> into the <code>Model</code> property under
   <code>Behavior Parameters (Script)</code> component in the Agent GameObject
   <strong>Inspector</strong> window.</li>
</ol>
<p><img alt="3dball learning brain" src="../images/3dball_learning_brain.png" /></p>
<ol>
<li>You should notice that each <code>Agent</code> under each <code>3DBall</code> in the <strong>Hierarchy</strong>
   windows now contains <strong>3DBall</strong> as <code>Model</code> on the <code>Behavior Parameters</code>.
   <strong>Note</strong> : You can modify multiple game objects in a scene by selecting them
   all at once using the search bar in the Scene Hierarchy.</li>
<li>Set the <strong>Inference Device</strong> to use for this model as <code>CPU</code>.</li>
<li>Click the <strong>Play</strong> button in the Unity Editor and you will see the platforms
   balance the balls using the pre-trained model.</li>
</ol>
<h2 id="training-a-new-model-with-reinforcement-learning">Training a new model with Reinforcement Learning</h2>
<p>While we provide pre-trained models for the agents in this environment, any
environment you make yourself will require training agents from scratch to
generate a new model file. In this section we will demonstrate how to use the
reinforcement learning algorithms that are part of the ML-Agents Python package
to accomplish this. We have provided a convenient command <code>mlagents-learn</code> which
accepts arguments used to configure both training and inference phases.</p>
<h3 id="training-the-environment">Training the environment</h3>
<ol>
<li>Open a command or terminal window.</li>
<li>Navigate to the folder where you cloned the <code>ml-agents</code> repository. <strong>Note</strong>:
   If you followed the default <a href="../Installation/">installation</a>, then you should
   be able to run <code>mlagents-learn</code> from any directory.</li>
<li>Run <code>mlagents-learn config/ppo/3DBall.yaml --run-id=first3DBallRun</code>.</li>
<li><code>config/ppo/3DBall.yaml</code> is the path to a default training
     configuration file that we provide. The <code>config/ppo</code> folder includes training configuration
     files for all our example environments, including 3DBall.</li>
<li><code>run-id</code> is a unique name for this training session.</li>
<li>When the message <em>"Start training by pressing the Play button in the Unity
   Editor"</em> is displayed on the screen, you can press the <strong>Play</strong> button in
   Unity to start training in the Editor.</li>
</ol>
<p>If <code>mlagents-learn</code> runs correctly and starts training, you should see something
like this:</p>
<pre><code class="language-console">INFO:mlagents_envs:
'Ball3DAcademy' started successfully!
Unity Academy name: Ball3DAcademy

INFO:mlagents_envs:Connected new brain:
Unity brain name: 3DBallLearning
        Number of Visual Observations (per agent): 0
        Vector Observation space size (per agent): 8
        Number of stacked Vector Observation: 1
INFO:mlagents_envs:Hyperparameters for the PPO Trainer of brain 3DBallLearning:
        batch_size:          64
        beta:                0.001
        buffer_size:         12000
        epsilon:             0.2
        gamma:               0.995
        hidden_units:        128
        lambd:               0.99
        learning_rate:       0.0003
        max_steps:           5.0e4
        normalize:           True
        num_epoch:           3
        num_layers:          2
        time_horizon:        1000
        sequence_length:     64
        summary_freq:        1000
        use_recurrent:       False
        memory_size:         256
        use_curiosity:       False
        curiosity_strength:  0.01
        curiosity_enc_size:  128
        output_path: ./results/first3DBallRun/3DBallLearning
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 1000. Mean Reward: 1.242. Std of Reward: 0.746. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 2000. Mean Reward: 1.319. Std of Reward: 0.693. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 3000. Mean Reward: 1.804. Std of Reward: 1.056. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 4000. Mean Reward: 2.151. Std of Reward: 1.432. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 5000. Mean Reward: 3.175. Std of Reward: 2.250. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 6000. Mean Reward: 4.898. Std of Reward: 4.019. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 7000. Mean Reward: 6.716. Std of Reward: 5.125. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 8000. Mean Reward: 12.124. Std of Reward: 11.929. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 9000. Mean Reward: 18.151. Std of Reward: 16.871. Training.
INFO:mlagents.trainers: first3DBallRun: 3DBallLearning: Step: 10000. Mean Reward: 27.284. Std of Reward: 28.667. Training.
</code></pre>
<p>Note how the <code>Mean Reward</code> value printed to the screen increases as training
progresses. This is a positive sign that training is succeeding.</p>
<p><strong>Note</strong>: You can train using an executable rather than the Editor. To do so,
follow the instructions in
<a href="../Learning-Environment-Executable/">Using an Executable</a>.</p>
<h3 id="observing-training-progress">Observing Training Progress</h3>
<p>Once you start training using <code>mlagents-learn</code> in the way described in the
previous section, the <code>ml-agents</code> directory will contain a <code>results</code>
directory. In order to observe the training process in more detail, you can use
TensorBoard. From the command line run:</p>
<pre><code class="language-sh">tensorboard --logdir results
</code></pre>
<p>Then navigate to <code>localhost:6006</code> in your browser to view the TensorBoard
summary statistics as shown below. For the purposes of this section, the most
important statistic is <code>Environment/Cumulative Reward</code> which should increase
throughout training, eventually converging close to <code>100</code> which is the maximum
reward the agent can accumulate.</p>
<p><img alt="Example TensorBoard Run" src="../images/mlagents-TensorBoard.png" /></p>
<h2 id="embedding-the-model-into-the-unity-environment">Embedding the model into the Unity Environment</h2>
<p>Once the training process completes, and the training process saves the model
(denoted by the <code>Saved Model</code> message) you can add it to the Unity project and
use it with compatible Agents (the Agents that generated the model). <strong>Note:</strong>
Do not just close the Unity Window once the <code>Saved Model</code> message appears.
Either wait for the training process to close the window or press <code>Ctrl+C</code> at
the command-line prompt. If you close the window manually, the <code>.onnx</code> file
containing the trained model is not exported into the ml-agents folder.</p>
<p>If you've quit the training early using <code>Ctrl+C</code> and want to resume training,
run the same command again, appending the <code>--resume</code> flag:</p>
<pre><code class="language-sh">mlagents-learn config/ppo/3DBall.yaml --run-id=first3DBallRun --resume
</code></pre>
<p>Your trained model will be at <code>results/&lt;run-identifier&gt;/&lt;behavior_name&gt;.onnx</code> where
<code>&lt;behavior_name&gt;</code> is the name of the <code>Behavior Name</code> of the agents corresponding
to the model. This file corresponds to your model's latest checkpoint. You can
now embed this trained model into your Agents by following the steps below,
which is similar to the steps described <a href="#running-a-pre-trained-model">above</a>.</p>
<ol>
<li>Move your model file into
   <code>Project/Assets/ML-Agents/Examples/3DBall/TFModels/</code>.</li>
<li>Open the Unity Editor, and select the <strong>3DBall</strong> scene as described above.</li>
<li>Select the <strong>3DBall</strong> prefab Agent object.</li>
<li>Drag the <code>&lt;behavior_name&gt;.onnx</code> file from the Project window of the Editor to
   the <strong>Model</strong> placeholder in the <strong>Ball3DAgent</strong> inspector window.</li>
<li>Press the <strong>Play</strong> button at the top of the Editor.</li>
</ol>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li>For more information on the ML-Agents Toolkit, in addition to helpful
  background, check out the <a href="../ML-Agents-Overview/">ML-Agents Toolkit Overview</a>
  page.</li>
<li>For a "Hello World" introduction to creating your own Learning Environment,
  check out the
  <a href="../Learning-Environment-Create-New/">Making a New Learning Environment</a> page.</li>
<li>For an overview on the more complex example environments that are provided in
  this toolkit, check out the
  <a href="../Learning-Environment-Examples/">Example Environments</a> page.</li>
<li>For more information on the various training options available, check out the
  <a href="../Training-ML-Agents/">Training ML-Agents</a> page.</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      com.unity.ml-agents copyright © 2017 - 2022 Unity Technologies
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>